<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Service</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    body {
      background: #f5f6fa;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }
    h1, h2, h3 {
      color: #2c3e50;
      margin-bottom: 20px;
    }

    /* Card Styles */
    .card {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 3px 15px rgba(0,0,0,0.05);
      margin-bottom: 30px;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    .form-group input, 
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
    }
    .form-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    .form-col {
      flex: 1;
    }

    /* Button Styles */
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      margin-right: 10px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn-primary {
      background: #2c3e50;
      color: white;
    }
    .btn-primary:hover {
      background: #34495e;
    }
    .btn-success {
      background: #27ae60;
      color: white;
    }
    .btn-danger {
      background: #e74c3c;
      color: white;
    }
    .btn-warning {
      background: #f39c12;
      color: white;
    }

    /* Queue Styles */
    .queue-container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .queue-section {
      flex: 1;
      min-width: 300px;
    }
    .queue-item {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .queue-item.active {
      background: #e8f4fd;
      border-left: 4px solid #3498db;
    }
    .queue-number {
      font-weight: 600;
      color: #2c3e50;
    }
    .badge {
      padding: 4px 8px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    .badge-general {
      background: #bdc3c7;
      color: #2c3e50;
    }
    .badge-account {
      background: #3498db;
      color: white;
    }
    .badge-loan {
      background: #9b59b6;
      color: white;
    }
    .badge-card {
      background: #e67e22;
      color: white;
    }

    /* Table Styles */
    .table-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 15px rgba(0,0,0,0.05);
      overflow-x: auto;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }
    th, td {
      padding: 12px 15px;
      border-bottom: 1px solid #ecf0f1;
      text-align: left;
    }
    th {
      background: #2c3e50;
      color: white;
      position: sticky;
      top: 0;
    }
    tr:hover {
      background: #f8f9fa;
    }

    /* Service Counter */
    .service-counter {
      background: #2c3e50;
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
    }
    .counter-number {
      font-size: 48px;
      font-weight: 700;
      margin: 10px 0;
    }
    
    /* Customers Served Counter */
    .customers-served {
      background: #27ae60;
      color: white;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .served-count {
      font-size: 32px;
      font-weight: 700;
      margin: 0 15px;
    }
    .served-label {
      font-size: 18px;
      font-weight: 500;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      .card {
        padding: 15px;
      }
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      .queue-container {
        flex-direction: column;
      }
      th, td {
        padding: 10px;
        font-size: 14px;
      }
      .btn {
        padding: 10px 15px;
        font-size: 14px;
        margin-bottom: 10px;
      }
    }

    @media (max-width: 480px) {
      .form-group input, 
      .form-group select,
      .form-group textarea {
        padding: 10px;
      }
      .queue-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-headset"></i> Customer Service Center</h1>

    <!-- Customers Served Counter -->
    <div class="customers-served">
      <i class="fas fa-users" style="font-size: 28px;"></i>
      <div class="served-count" id="customers-served-count">0</div>
      <div class="served-label">Customers Served Today</div>
    </div>

    <!-- Service Counter -->
    <div class="service-counter">
      <h2><i class="fas fa-ticket-alt"></i> Now Serving</h2>
      <div class="counter-number" id="current-ticket">-</div>
      <p id="current-customer">No customer being served</p>
    </div>

    <!-- Customer Queue Management -->
    <div class="queue-container">
      <!-- Add to Queue -->
      <div class="card queue-section">
        <h2><i class="fas fa-user-plus"></i> Add to Queue</h2>
        <form id="queue-form">
          <div class="form-group">
            <label for="customer-name">Customer Name</label>
            <input type="text" id="customer-name" required>
          </div>
          <div class="form-group">
            <label for="account-number">Account Number</label>
            <input type="text" id="account-number">
          </div>
          <div class="form-group">
            <label for="service-type">Service Type</label>
            <select id="service-type" required>
              <option value="">Select Service</option>
              <option value="general">General Inquiry</option>
              <option value="account">Account Services</option>
              <option value="loan">Loan Services</option>
              <option value="card">Card Services</option>
            </select>
          </div>
          <div class="form-group">
            <label for="service-notes">Service Notes</label>
            <textarea id="service-notes" rows="2"></textarea>
          </div>
          <button type="submit" class="btn btn-success">
            <i class="fas fa-plus-circle"></i> Add to Queue
          </button>
        </form>
      </div>

      <!-- Current Queue -->
      <div class="card queue-section">
        <h2><i class="fas fa-list-ol"></i> Current Queue</h2>
        <div id="queue-list">
          <!-- Queue items will be added here -->
          <div class="queue-item" id="no-queue">
            <span>No customers in queue</span>
          </div>
        </div>
        <button id="next-customer-btn" class="btn btn-primary" style="margin-top: 15px; width: 100%;">
          <i class="fas fa-arrow-right"></i> Serve Next Customer
        </button>
      </div>
    </div>

    <!-- Service History -->
    <div class="table-container">
      <h2><i class="fas fa-history"></i> Service History</h2>
      <table id="service-history-table">
        <thead>
          <tr>
            <th>Ticket #</th>
            <th>Customer</th>
            <th>Account #</th>
            <th>Service Type</th>
            <th>Time Started</th>
            <th>Time Completed</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="service-history">
          <!-- Service history will be loaded here -->
        </tbody>
      </table>
      <div id="no-history" style="text-align: center; padding: 20px;">
        <i class="fas fa-info-circle" style="font-size: 24px; color: #7f8c8d;"></i>
        <p>No service history available</p>
      </div>
    </div>
  </div>

  <!-- Service Modal -->
  <div id="service-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background: white; padding: 30px; border-radius: 10px; max-width: 500px; width: 90%;">
      <h3 id="modal-title"><i class="fas fa-user-tie"></i> Serving Customer</h3>
      <div id="modal-content">
        <p><strong>Ticket #:</strong> <span id="modal-ticket">-</span></p>
        <p><strong>Customer:</strong> <span id="modal-customer">-</span></p>
        <p><strong>Account #:</strong> <span id="modal-account">-</span></p>
        <p><strong>Service Type:</strong> <span id="modal-service">-</span></p>
        <p><strong>Notes:</strong> <span id="modal-notes">-</span></p>
        
        <div class="form-group" style="margin-top: 20px;">
          <label for="resolution-notes">Resolution Notes</label>
          <textarea id="resolution-notes" rows="3" placeholder="Enter resolution details..."></textarea>
        </div>
      </div>
      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button id="complete-service-btn" class="btn btn-success">
          <i class="fas fa-check-circle"></i> Complete Service
        </button>
        <button id="cancel-service-btn" class="btn btn-danger">
          <i class="fas fa-times"></i> Cancel
        </button>
      </div>
    </div>
  </div>

  <!-- JavaScript for Customer Service -->
  <script>
    // Customer Service Data
    let customerQueue = JSON.parse(localStorage.getItem('customerQueue')) || [];
    let serviceHistory = JSON.parse(localStorage.getItem('serviceHistory')) || [];
    let currentService = null;
    let ticketCounter = 1000;
    
    // Track customers served today
    let customersServed = parseInt(localStorage.getItem('customersServed')) || 0;
    const todayDate = new Date().toDateString();
    const lastServiceDate = localStorage.getItem('lastServiceDate');
    
    // Reset counter if it's a new day
    if (lastServiceDate !== todayDate) {
      customersServed = 0;
      localStorage.setItem('lastServiceDate', todayDate);
      localStorage.setItem('customersServed', customersServed);
    }

    // DOM Elements
    const queueForm = document.getElementById('queue-form');
    const queueList = document.getElementById('queue-list');
    const noQueueItem = document.getElementById('no-queue');
    const nextCustomerBtn = document.getElementById('next-customer-btn');
    const serviceHistoryTable = document.getElementById('service-history');
    const noHistoryMsg = document.getElementById('no-history');
    const currentTicketDisplay = document.getElementById('current-ticket');
    const currentCustomerDisplay = document.getElementById('current-customer');
    const serviceModal = document.getElementById('service-modal');
    const customersServedDisplay = document.getElementById('customers-served-count');

    // Initialize
    function init() {
      updateQueueDisplay();
      updateServiceHistory();
      updateCounterDisplay();
      updateCustomersServedDisplay();
      
      // Set ticket counter to highest existing ticket + 1
      if (serviceHistory.length > 0) {
        const highestTicket = Math.max(...serviceHistory.map(item => parseInt(item.ticketNumber.slice(1))));
        ticketCounter = highestTicket + 1;
      }
    }

    // Update Queue Display
    function updateQueueDisplay() {
      queueList.innerHTML = '';
      
      if (customerQueue.length === 0) {
        noQueueItem.style.display = 'flex';
        queueList.appendChild(noQueueItem);
        nextCustomerBtn.disabled = true;
        return;
      }
      
      noQueueItem.style.display = 'none';
      nextCustomerBtn.disabled = false;
      
      customerQueue.forEach((customer, index) => {
        const queueItem = document.createElement('div');
        queueItem.className = `queue-item ${index === 0 ? 'active' : ''}`;
        
        const serviceClass = `badge-${customer.serviceType}`;
        
        queueItem.innerHTML = `
          <div>
            <span class="queue-number">Ticket #T${customer.ticketNumber}</span>
            <div>${customer.customerName}</div>
          </div>
          <span class="badge ${serviceClass}">
            ${customer.serviceType.charAt(0).toUpperCase() + customer.serviceType.slice(1)}
          </span>
        `;
        
        queueList.appendChild(queueItem);
      });
    }

    // Update Service History
    function updateServiceHistory() {
      serviceHistoryTable.innerHTML = '';
      
      if (serviceHistory.length === 0) {
        noHistoryMsg.style.display = 'block';
        return;
      }
      
      noHistoryMsg.style.display = 'none';
      
      serviceHistory.slice().reverse().forEach(service => {
        const row = document.createElement('tr');
        const serviceClass = `badge-${service.serviceType}`;
        
        row.innerHTML = `
          <td>T${service.ticketNumber}</td>
          <td>${service.customerName}</td>
          <td>${service.accountNumber || '-'}</td>
          <td><span class="badge ${serviceClass}">${service.serviceType.charAt(0).toUpperCase() + service.serviceType.slice(1)}</span></td>
          <td>${new Date(service.startTime).toLocaleTimeString()}</td>
          <td>${service.endTime ? new Date(service.endTime).toLocaleTimeString() : '-'}</td>
          <td>${service.completed ? 'Completed' : 'Pending'}</td>
        `;
        
        serviceHistoryTable.appendChild(row);
      });
    }

    // Update Counter Display
    function updateCounterDisplay() {
      if (currentService) {
        currentTicketDisplay.textContent = `T${currentService.ticketNumber}`;
        currentCustomerDisplay.textContent = `${currentService.customerName} (${currentService.serviceType})`;
      } else {
        currentTicketDisplay.textContent = '-';
        currentCustomerDisplay.textContent = 'No customer being served';
      }
    }
    
    // Update Customers Served Display
    function updateCustomersServedDisplay() {
      customersServedDisplay.textContent = customersServed;
    }

    // Add to Queue
    queueForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const ticketNumber = ticketCounter++;
      const newCustomer = {
        ticketNumber,
        customerName: document.getElementById('customer-name').value,
        accountNumber: document.getElementById('account-number').value || null,
        serviceType: document.getElementById('service-type').value,
        notes: document.getElementById('service-notes').value || null,
        queueTime: new Date().toISOString()
      };
      
      customerQueue.push(newCustomer);
      saveData();
      updateQueueDisplay();
      queueForm.reset();
      
      alert(`Ticket #T${ticketNumber} created for ${newCustomer.customerName}`);
    });

    // Serve Next Customer
    nextCustomerBtn.addEventListener('click', function() {
      if (customerQueue.length === 0) return;
      
      currentService = customerQueue.shift();
      currentService.startTime = new Date().toISOString();
      
      // Update modal content
      document.getElementById('modal-ticket').textContent = `T${currentService.ticketNumber}`;
      document.getElementById('modal-customer').textContent = currentService.customerName;
      document.getElementById('modal-account').textContent = currentService.accountNumber || '-';
      document.getElementById('modal-service').textContent = 
        currentService.serviceType.charAt(0).toUpperCase() + currentService.serviceType.slice(1);
      document.getElementById('modal-notes').textContent = currentService.notes || 'No notes';
      document.getElementById('resolution-notes').value = '';
      
      serviceModal.style.display = 'flex';
      updateCounterDisplay();
      saveData();
    });

    // Complete Service
    document.getElementById('complete-service-btn').addEventListener('click', function() {
      if (!currentService) return;
      
      currentService.endTime = new Date().toISOString();
      currentService.completed = true;
      currentService.resolutionNotes = document.getElementById('resolution-notes').value || null;
      
      serviceHistory.push(currentService);
      currentService = null;
      
      // Increment customers served counter
      customersServed++;
      localStorage.setItem('customersServed', customersServed);
      localStorage.setItem('lastServiceDate', todayDate);
      
      serviceModal.style.display = 'none';
      updateQueueDisplay();
      updateServiceHistory();
      updateCounterDisplay();
      updateCustomersServedDisplay();
      saveData();
    });

    // Cancel Service
    document.getElementById('cancel-service-btn').addEventListener('click', function() {
      if (!currentService) return;
      
      // Return customer to front of queue
      customerQueue.unshift(currentService);
      currentService = null;
      
      serviceModal.style.display = 'none';
      updateQueueDisplay();
      updateCounterDisplay();
      saveData();
    });

    // Save Data to Local Storage
    function saveData() {
      localStorage.setItem('customerQueue', JSON.stringify(customerQueue));
      localStorage.setItem('serviceHistory', JSON.stringify(serviceHistory));
    }

    // Initialize
    init();
  </script>
</body>
</html>